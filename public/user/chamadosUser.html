<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Maximum Help • Chamados</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/assets/css/style.css" />
</head>

<body>
  <div class="admin-shell">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar"></aside>

    <!-- Main -->
    <section class="main">
      <!-- Topbar padrão -->
      <div class="topbar fade-in">
        <div class="d-flex align-items-center gap-2">
          <button class="sidebar-toggle" id="btnSidebarToggle" type="button">
            <i data-lucide="panel-left" style="width:18px;height:18px;"></i>
          </button>
          <div class="topbar-title" id="moduleTitle">Chamados</div>
        </div>

        <div class="topbar-actions d-flex align-items-center gap-2">
          <button class="btn btn-outline-secondary btn-sm" id="btnRefresh" type="button">
            <i data-lucide="refresh-cw" style="width:16px;height:16px;"></i>
            Atualizar
          </button>

          <button class="btn btn-outline-danger btn-sm" id="btnLogoutTop" type="button">
            <i data-lucide="log-out" style="width:16px;height:16px;"></i>
            Sair
          </button>
        </div>
      </div>

      <!-- Content (somente aqui muda) -->
      <div class="container-fluid py-4">
        <div id="pageAlert" class="mb-3"></div>

        <div class="d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3">
          <div class="d-flex flex-wrap gap-2 align-items-center">
            <!-- view toggle removido (somente lista) -->

            <div class="input-group input-group-sm" style="width: 320px;">
              <span class="input-group-text"><i data-lucide="search" style="width:16px;height:16px;"></i></span>
              <input class="form-control" id="q" placeholder="Buscar por título, descrição, solicitante..." />
            </div>

            <select class="form-select form-select-sm" id="statusFilter" style="width: 220px;">
              <option value="">Status (todos)</option>
            </select>

            <select class="form-select form-select-sm" id="urgFilter" style="width: 190px;">
              <option value="">Urgência (todas)</option>
              <option value="true">Somente urgentes</option>
              <option value="false">Somente não urgentes</option>
            </select>
          </div>

          <button class="btn btn-marsala" id="btnOpenCreate" type="button">
            <i data-lucide="plus" style="width:16px;height:16px;"></i>
            Novo chamado
          </button>
        </div>

        <!-- LISTA -->
        <div id="listView" class="fade-in">
          <div id="ticketsEmpty" class="empty-state d-none">
            <div class="empty-icon"><i data-lucide="inbox" style="width:20px;height:20px;"></i></div>
            <div class="empty-title">Nenhum chamado encontrado</div>
            <div class="empty-sub">Crie um chamado ou ajuste os filtros.</div>
          </div>

          <div id="ticketsGrid" class="tickets-grid"></div>
        </div>
</div>
      </div>
    </section>
  </div>

  <!-- Modal: Criar/Editar -->
  <div class="modal fade" id="modalTicket" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalTicketTitle">Novo chamado</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
        </div>
        <div class="modal-body">
          <div id="createErr" class="text-danger small mb-2 d-none"></div>

          <form id="ticketForm">
            <div class="row g-3">
              <div class="col-12">
                <label class="form-label">Título</label>
                <input id="fTitulo" class="form-control" maxlength="120" placeholder="Ex: Solicitação / Problema..." />
              </div>

              <div class="col-12">
                <label class="form-label">Solicitante (campo aberto - opcional)</label>
                <input id="fSolicitanteAberto" class="form-control" maxlength="80" placeholder="Ex: Cliente X, Filial Y..." />
              </div>

              <div class="col-12">
                <label class="form-label">Descrição</label>
                <textarea id="fDescricao" class="form-control" rows="4" placeholder="Descreva com detalhes..."></textarea>
              </div>

              <div class="col-md-5">
                <label class="form-label">Status</label>
                <select id="fStatus" class="form-select">
                  <option value="Pendente">Pendente</option>
                  <option value="Em Andamento">Em Andamento</option>
                  <option value="Aguardando Responsável">Aguardando Responsável</option>
                  <option value="Aguardando Solicitante">Aguardando Solicitante</option>
                  <option value="Concluído">Concluído</option>
                </select>
              </div>

              <div class="col-md-4">
                <label class="form-label">Urgente</label>
                <select id="fUrgente" class="form-select">
                  <option value="false">Não</option>
                  <option value="true">Sim</option>
                </select>
              </div>

              <div class="col-md-3">
                <label class="form-label">Prazo (em dias)</label>
                <input id="fPrazoDias" type="number" class="form-control" min="0" step="1" placeholder="Ex: 3" />
              </div>

              <div class="col-12">
                <label class="form-label">Anexos</label>
                <input id="fFiles" class="form-control" type="file" multiple />
                <div class="form-text">Arquivos são salvos em <code>/uploads/tickets</code> e o banco guarda somente metadados.</div>
                <div id="selectedFiles" class="mt-2 small text-muted"></div>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-outline-secondary" data-bs-dismiss="modal" type="button">Cancelar</button>
          <button class="btn btn-marsala" id="btnSaveTicket" type="button">Salvar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal: Detalhes -->
  <div class="modal fade" id="modalDetails" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Detalhes do chamado</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
        </div>
        <div class="modal-body" id="detailsBody"></div>
        <div class="modal-footer">
          <button class="btn btn-outline-secondary" data-bs-dismiss="modal" type="button">Fechar</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script src="/assets/js/api.js"></script>
  <script src="/assets/js/userCommon.js"></script>
<script src="/assets/js/chamadosUser.js"></script>
  <script src="/assets/js/partials.js"></script>

  
</body>
</html>
